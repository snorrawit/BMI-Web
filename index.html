<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Health & BMI</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

body{
font-family:tahoma;
margin:0;
background:linear-gradient(135deg,#dfe9f3,#f3f5f9);
animation:fadeIn 1s ease;
}

@keyframes fadeIn{
from{opacity:0;}
to{opacity:1;}
}

.main{
padding:20px;
max-width:900px;
margin:auto;
}

.card{
background:white;
padding:20px;
border-radius:18px;
box-shadow:0 6px 20px rgba(0,0,0,0.08);
margin-bottom:20px;
transition:0.4s;
animation:slideUp 0.6s ease;
}

.card:hover{
transform:translateY(-5px);
}

@keyframes slideUp{
from{transform:translateY(20px);opacity:0;}
to{transform:translateY(0);opacity:1;}
}

input{
width:100%;
padding:10px;
margin:8px 0;
border-radius:10px;
border:1px solid #ccc;
box-sizing:border-box;
transition:0.3s;
}

input:focus{
border-color:#667eea;
outline:none;
box-shadow:0 0 6px rgba(102,126,234,0.4);
}

button{
padding:12px;
border:none;
border-radius:12px;
background:#667eea;
color:white;
cursor:pointer;
width:100%;
margin-top:10px;
transition:0.3s;
font-weight:bold;
}

button:hover{
background:#5563d6;
transform:translateY(-2px);
box-shadow:0 6px 15px rgba(0,0,0,0.2);
}

table{
width:100%;
border-collapse:collapse;
margin-top:10px;
}

td,th{
border:1px solid #ddd;
padding:10px;
text-align:center;
}

</style>
</head>

<body>

<!-- ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô -->
<div id="sleepAlert" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);color:white;align-items:center;justify-content:center;flex-direction:column;z-index:999;">
<h1>üåô ‡∏Ñ‡∏ß‡∏£‡∏ô‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß</h1>
<button onclick="enterSite()">‡∏ï‡∏Å‡∏•‡∏á ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</button>
</div>

<div class="main">

<h1 style="text-align:center;">Health & BMI</h1>

<div class="card" id="loginBox">
<h3>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h3>
<input id="user" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ">
<input id="pass" type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
<button onclick="register()">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
<button onclick="login()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
</div>

<div id="home" style="display:none">

<div class="card">
<h3 id="welcome"></h3>

<h2 id="clock"></h2>
<h3 id="streakText"></h3>

<input id="height" placeholder="‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡∏ã‡∏°.)">
<input id="weight" placeholder="‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å‡∏Å.)">
<input id="goal" placeholder="‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (‡∏Å‡∏Å.)">

<button onclick="saveData()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>

<h4 id="goalText"></h4>
<h4 id="bmiLevel"></h4>
</div>

<div class="card">
<h3>‡∏Å‡∏£‡∏≤‡∏ü‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å</h3>
<canvas id="weightChart"></canvas>
</div>

<div class="card">
<h3>‡∏Å‡∏£‡∏≤‡∏ü BMI</h3>
<canvas id="bmiChart"></canvas>
</div>

<div class="card">
<h3>üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏î‡∏±‡∏ä‡∏ô‡∏µ BMI</h3>
<table>
<tr><th>BMI</th><th>‡∏£‡∏∞‡∏î‡∏±‡∏ö</th></tr>
<tr><td>‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 18.5</td><td>‡∏ú‡∏≠‡∏°</td></tr>
<tr><td>18.5 - 22.9</td><td>‡∏õ‡∏Å‡∏ï‡∏¥</td></tr>
<tr><td>23 - 24.9</td><td>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô</td></tr>
<tr><td>25 - 29.9</td><td>‡∏≠‡πâ‡∏ß‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö 1</td></tr>
<tr><td>30 ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ</td><td>‡∏≠‡πâ‡∏ß‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö 2</td></tr>
</table>
</div>

<button onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>

</div>

</div>

<script>

let currentUser="";
let weightChart;
let bmiChart;

/* ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô 22:00 - 05:00 */
let hour=new Date().getHours();
if(hour>=22 || hour<5){
sleepAlert.style.display="flex";
}

function enterSite(){
sleepAlert.style.display="none";
}

/* Clock */
setInterval(()=>{
clock.innerText=new Date().toLocaleTimeString();
},1000);

/* Register */
function register(){
let u=user.value;
let p=pass.value;
if(!u||!p) return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");
localStorage.setItem("user_"+u,p);
alert("‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
}

/* Login */
function login(){

let u=user.value;
let p=pass.value;

if(localStorage.getItem("user_"+u)===p){

currentUser=u;
loginBox.style.display="none";
home.style.display="block";
welcome.innerText="‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ "+u;

loadCharts();
updateStreak();

}else alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");

}

/* Save Data */
function saveData(){

let h=height.value/100;
let w=weight.value;
let goalValue=goal.value;

if(!h||!w) return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");

let bmi=(w/(h*h)).toFixed(2);

let history=JSON.parse(localStorage.getItem("history_"+currentUser))||[];

history.push({
date:new Date().toLocaleDateString(),
weight:Number(w),
bmi:Number(bmi)
});

localStorage.setItem("history_"+currentUser,JSON.stringify(history));

/* Goal */
if(goalValue){
let diff=(w-goalValue).toFixed(1);
goalText.innerText= diff>0 ? "‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏•‡∏î‡∏≠‡∏µ‡∏Å "+diff+" ‡∏Å‡∏Å." : "‡∏ñ‡∏∂‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß üéâ";
}

/* BMI Level */
let level="";
if(bmi<18.5) level="‡∏ú‡∏≠‡∏°";
else if(bmi<23) level="‡∏õ‡∏Å‡∏ï‡∏¥";
else if(bmi<25) level="‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô";
else if(bmi<30) level="‡∏≠‡πâ‡∏ß‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö1";
else level="‡∏≠‡πâ‡∏ß‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö2";

bmiLevel.innerText="‡∏£‡∏∞‡∏î‡∏±‡∏ö BMI : "+level;

/* Streak */
let today=new Date().toLocaleDateString();
let lastDate=localStorage.getItem("lastDate_"+currentUser);
let streak=Number(localStorage.getItem("streak_"+currentUser)||0);

if(!lastDate){
streak=1;
}else{

let y=new Date();
y.setDate(y.getDate()-1);
y=y.toLocaleDateString();

if(lastDate===y) streak++;
else if(lastDate!==today) streak=1;
}

localStorage.setItem("streak_"+currentUser,streak);
localStorage.setItem("lastDate_"+currentUser,today);

updateStreak();
loadCharts();

}

/* Update Streak */
function updateStreak(){
let s=Number(localStorage.getItem("streak_"+currentUser)||0);
streakText.innerText="üî•".repeat(s)+" ("+s+" ‡∏ß‡∏±‡∏ô)";
}

/* Charts */
function loadCharts(){

let history=JSON.parse(localStorage.getItem("history_"+currentUser))||[];

let labels=history.map(h=>h.date);
let weights=history.map(h=>h.weight);
let bmis=history.map(h=>h.bmi);

if(weightChart) weightChart.destroy();
if(bmiChart) bmiChart.destroy();

weightChart=new Chart(document.getElementById("weightChart"),{
type:"line",
data:{labels:labels,datasets:[{label:"‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å",data:weights}]}
});

bmiChart=new Chart(document.getElementById("bmiChart"),{
type:"line",
data:{labels:labels,datasets:[{label:"BMI",data:bmis}]}
});

}

/* Logout */
function logout(){
location.reload();
}

</script>

</body>
</html>
